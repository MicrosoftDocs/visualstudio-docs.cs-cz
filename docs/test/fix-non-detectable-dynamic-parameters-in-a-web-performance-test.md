---
title: Opravit nezjistitelné dynamické parametry (test výkonnosti webu)
description: Zjistěte, jak modul pro záznam a přehrávání testů výkonnosti webu automaticky zpracovává nejběžnější typy dynamických parametrů.
ms.custom: SEO-VS-2020
ms.date: 10/19/2016
ms.topic: how-to
helpviewer_keywords:
- walkthroughs, load tests
- load tests, walkthroughs
- load tests, correlating dynamic parameters
ms.assetid: 92dff25c-36ee-4135-acdd-315c4962fa11
author: mikejo5000
ms.author: mikejo
manager: jmartens
ms.openlocfilehash: 5d1e1c35feba87ada3b98d13c5d43c436fd91b1d
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 02/08/2021
ms.locfileid: "99936558"
---
# <a name="fix-non-detectable-dynamic-parameters-in-a-web-performance-test"></a>Oprava nedetekovatelných dynamických parametrů v testu výkonnosti webu

Některé webové servery používají dynamické parametry ke zpracování některých webových požadavků. Dynamický parametr je parametr, jehož hodnota je znovu vygenerována při každém spuštění aplikace uživatelem. Příkladem dynamického parametru je ID relace. ID relace se obvykle mění každých 5 až 30 minut. Modul pro záznam a přehrávání testu výkonnosti webu automaticky zpracovává nejběžnější typy dynamických parametrů:

- Dynamické hodnoty parametrů, které jsou nastaveny v hodnotě souboru cookie. Modul testu výkonnosti webu je automaticky zpracovává během přehrávání.

- Hodnoty dynamického parametru, které jsou nastaveny ve skrytých polích na stránkách HTML, například ASP.NET stav zobrazení. Tyto jsou automaticky zpracovány zapisovačem, který do testu přidá skrytá pravidla extrakce polí.

- Dynamické hodnoty parametrů, které jsou nastaveny jako řetězce dotazu nebo parametry formuláře post. Tyto jsou zpracovány prostřednictvím zjišťování dynamického parametru po zaznamenání testu výkonnosti webu.

Některé typy dynamických parametrů nebyly zjištěny. Nezjištěný dynamický parametr způsobí, že test výkonnosti webu selže při spuštění, protože dynamická hodnota bude při každém spuštění testu odlišná. Pro správné zpracování těchto parametrů můžete přidat pravidla extrakce do dynamických parametrů v testech výkonnosti webu ručně.

[!INCLUDE [web-load-test-deprecated](includes/web-load-test-deprecated.md)]

## <a name="create-and-run-a-web-app-with-dynamic-parameters"></a>Vytvoření a spuštění webové aplikace s dynamickými parametry

Pro demonstraci zjistitelného a nezjistitelného dynamického parametru vytvoříme jednoduchou webovou aplikaci ASP.NET, která má tři webové formuláře s několika ovládacími prvky a nějaký vlastní kód. Pak se dozvíte, jak izolovat dynamické parametry a jak je zpracovat.

1. Vytvořte nový projekt ASP.NET s názvem **DynamicParameterSample**.

     ![Vytvoření prázdného projektu webové aplikace v ASP.NET](../test/media/web_test_dynamicparameter_aspproject.png)

2. Přidejte webový formulář s názvem *QueryString. aspx*.

3. V návrhovém zobrazení přetáhněte na stránku HiddenField a potom změňte hodnotu vlastnosti (ID) na HiddenFieldSessionID.

     ![Přidat HiddenField](../test/media/web_test_dynamicparameter_hiddenfield.png)

4. Přejděte do zobrazení zdroje pro stránku QueryString a přidejte následující zvýrazněný kód ASP.NET a JavaScript, který slouží ke generování dynamických parametrů ID relace:

    ```html
    <head runat="server">
    <title>JavaScript dynamic property correlation sample</title><script type="text/javascript" language="javascript">    <!--        function jScriptQueryString()         {            var Hidden = document.getElementById("HiddenFieldSessionID");            var sessionId = Hidden.value;            window.location = 'JScriptQuery.aspx?CustomQueryString=jScriptQueryString___' + sessionId;         }    //--></script>
    </head>
    <body>
        <form id="form1" runat="server">
        <div>
             <a name="QuerystringHyperlink" href="ASPQuery.aspx?CustomQueryString=ASPQueryString___<%= Session.SessionID %>">Dynamic querystring generated by ASP.net</a>         <br/>         <br/>         <a href="javascript:jScriptQueryString()">Dynamic querystring generated by javascript </a>
        </div>
        <asp:HiddenField ID="HiddenFieldSessionID" runat="server" />
        </form>
    </body>
    </html>
    ```

5. Otevřete soubor *QueryString.aspx.cs* a do metody Page_Load přidejte následující zvýrazněný kód:

    ```csharp
    public partial class Querystring : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {
            Session.Add("Key", "Value");HiddenFieldSessionID.Value = Session.SessionID;
        }
    }
    ```

6. Přidejte druhý webový formulář s názvem *ASPQuery. aspx*.

7. V zobrazení Návrh přetáhněte **popisek** na stránku a změňte hodnotu vlastnosti **(ID)** na **IndexLabel**.

     ![Přidání popisku do webového formuláře](../test/media/web_test_dynamicparameter_label.png)

8. Přetáhněte **hypertextový odkaz** na stránku a změňte hodnotu pro jeho vlastnost **text** na **zpět**.

     ![Přidání hypertextového odkazu do webového formuláře](../test/media/web_test_dynamicparameter_hyperlink.png)

9. Pro vlastnost **NavigationURL** vyberte **(...)** .

     ![Upravit vlastnost NavigateURL](../test/media/web_test_dynamicparameter_hyperlink_navurl.png)

     Vyberte *QueryString. aspx*.

     ![Vyberte adresu URL řetězce dotazu QueryString. aspx.](../test/media/web_test_dynamicparameter_hyperlink_navurl2.png)

10. Otevřete soubor *ASPQuery.aspx.cs* a do metody Page_Load přidejte následující zvýrazněný kód:

    ```csharp
    protected void Page_Load(object sender, EventArgs e)
            {
                int index;            string qstring;            string dateportion;            string sessionidportion;            qstring = Request.QueryString["CustomQueryString"];            index = qstring.IndexOf("___");            dateportion = qstring.Substring(0, index);            index += 3;            sessionidportion = qstring.Substring(index, qstring.Length - index);            if (sessionidportion != Session.SessionID)            {                Response.StatusCode = 401;                IndexLabel.Text = "Failure!  Invalid querystring parameter found.";            }            else            {                IndexLabel.Text = "Success.  Dynamic querystring parameter was found.";            }            IndexLabel.Text += "<br>\r\n";
            }
    ```

11. Přidejte třetí webový formulář s názvem *JScriptQuery. aspx*.

     Stejně jako u druhé stránky jsme přetáhli **popisek** do formuláře, nastavete jeho vlastnost **(ID)** na **IndexLabel** a přetáhnete **hypertextový odkaz** na formulář, nastavíte jeho vlastnost **text** na **zpět** a jeho vlastnost **NavigationURL** na **QueryString. aspx**.

     ![Přidání a konfigurace třetího webového formuláře](../test/media/web_test_dynamicparameter_addwebform3.png)

12. Otevřete soubor *JScriptQuery.aspx.cs* a do metody Page_Load přidejte následující zvýrazněný kód:

    ```csharp
    protected void Page_Load(object sender, EventArgs e)
            {
                int index;            string qstring;            string dateportion;            string sessionidportion;            qstring = Request.QueryString["CustomQueryString"];            index = qstring.IndexOf("___");            dateportion = qstring.Substring(0, index);            index += 3;            sessionidportion = qstring.Substring(index, qstring.Length - index);            if (sessionidportion != Session.SessionID)            {                Response.StatusCode = 401;                IndexLabel.Text = "Failure!  Invalid querystring parameter found.";            }            else            {                IndexLabel.Text = "Success.  Dynamic querystring parameter was found.";            }            IndexLabel.Text += "<br>\r\n";
            }
    ```

13. Uložte projekt.

14. V **Průzkumník řešení** jako úvodní stránku nastavte *QueryString. aspx* .

     ![Nastavení úvodní stránky na QueryString. aspx](../test/media/web_test_dynamicparameter_setstartpage.png)

15. Stisknutím klávesy **CTRL** + **F5** spusťte webovou aplikaci v prohlížeči. Zkopírujte adresu URL. Budete ho potřebovat při záznamu testu.

16. Vyzkoušejte oba odkazy. Každá z nich by měla zobrazovat zprávu "úspěch. Našel se dynamický parametr QueryString.

     ![Spusťte webovou aplikaci](../test/media/web_test_dynamicparameter_runapp.png)

     ![Úspěch&#33;](../test/media/web_test_dynamicparameter_runapp2.png)

## <a name="create-a-web-performance-test"></a>Vytvoření testu výkonnosti webu

1. Přidejte do svého řešení projekt webového výkonu a zátěžového testu.

     ![Přidání projektu webového kategorie a zátěžového testu](../test/media/web_test_dynamicparameter_addtestproject.png)

2. Přejmenujte WebTest1. webtest na DynamicParameterSampleApp. WebTest.

     ![Přejmenování testu výkonnosti webu](../test/media/web_test_dynamicparameter_renametest.png)

3. Poznamenejte si test.

     ![Zaznamenat test výkonnosti webu](../test/media/web_test_dynamicparameter_recordtest.png)

4. Zkopírujte a vložte adresu URL z webu, který testujete, do prohlížeče.

     ![Vložte adresu URL z testovaného webu.](../test/media/web_test_dynamicparameter_recordtest2.png)

5. Procházení webové aplikace. Zvolte odkaz ASP.NET, zpět odkaz a potom odkaz JavaScript následovaný zpětným odkazem.

     Záznam webového testu zobrazuje požadavek HTTP a adresy URL odpovědí při procházení webové aplikace.

6. V záznamu testu klikněte na tlačítko **zastavit** .

     Dialogové okno pro zjišťování dynamických parametrů zobrazuje indikátor průběhu, který zobrazuje stav detekce parametrů v odpovědích HTTP, které byly přijaty.

7. Automaticky se detekuje dynamický parametr pro CustomQueryString na stránce ASPQuery. Nicméně dynamický parametr pro CustomQueryString na stránce JScriptQuery není zjištěn.

     Kliknutím na **tlačítko OK** přidejte pravidlo extrakce do *QueryString. aspx* a navážete ho na stránku ASPQuery.

     ![Zvýšit úroveň zjištěného dynamického parametru](../test/media/web_test_dynamicparameter_promotedialog.png)

     Pravidlo extrakce je přidáno k první žádosti o *QueryString. aspx*.

     ![Pravidlo extrakce přidané do žádosti](../test/media/web_test_dynamicparameter_autoextractionrule.png)

     Rozbalte druhou žádost ve stromu žádosti pro *ASPQuery. aspx* a Všimněte si, že hodnota CustomQueryString je vázaná na pravidlo extrakce.

     ![CustomQueryString vázané na pravidlo extrakce](../test/media/web_test_dynamicparameter_autoextractionrule2.png)

8. Uložte test.

## <a name="run-the-test-to-isolate-the-non-detected-dynamic-parameter"></a>Spusťte test pro izolaci nerozpoznaného dynamického parametru

1. Spusťte test.

     ![Spustit test výkonnosti webu](../test/media/web_test_dynamicparameter_runtest.png)

2. Čtvrtá žádost na stránku *JScriptQuery. aspx* se nezdařila. Přejít na webový test.

     ![Chyba dynamického parametru ve výsledcích testu](../test/media/web_test_dynamicparameter_runresults.png)

     V editoru je zvýrazněn uzel požadavku *JScriptQuery. aspx* . Rozbalte uzel a Všimněte si, že část CustomQueryString "1v0yhyiyr0raa2w4j4pwf5zl" je pravděpodobně dynamická.

     ![Podezření na dynamický parametr v CustomQueryString](../test/media/web_test_dynamicparameter_runresults2.png)

3. Vraťte se do prohlížeče webového výkonu Výsledky testů Viewer a vyberte stránku *JScriptQuery. aspx* , která se nezdařila. Pak klikněte na kartu žádost, ověřte, že je zaškrtnuté políčko Zobrazit nezpracovaná data, přejděte dolů a zvolte rychlé hledání na CustomQueryString.

     ![Snímek obrazovky s kartou Request v prohlížeči výsledků textu výkonu webu Je vybrán parametr QueryString a v místní nabídce je zvýrazněna možnost QuickFind.](../test/media/web_test_dynamicparameter_runresultsquckfind.png)

4. Víme od zobrazení editoru testů, že CustomQueryString žádosti *JScriptQuery. aspx* byla přiřazena hodnota: `jScriptQueryString___1v0yhyiyr0raa2w4j4pwf5zl` a podezřelá dynamická část je "1v0yhyiyr0raa2w4j4pwf5zl". V rozevíracím seznamu najít odstraňte podezřelou část hledaného řetězce. Řetězec by měl být "CustomQueryString = jScriptQueryString___".

     Dynamické parametry jsou přiřazeny jejich hodnotám v jednom z požadavků, které předcházejí žádosti, která obsahuje chybu. Proto zaškrtněte políčko Hledat nahoru a zvolte Najít další, dokud se na panelu žádosti nezobrazí předchozí požadavek na *QueryString. aspx* . Tato situace by se měla objevit po třech případech, kdy zvolíte Najít další.

     ![Snímek obrazovky prohlížeče výsledků textu výkonu webu Je vybraný řetězec dotazu a zobrazí se dialogové okno najít s SearchUp a najít další vybraný.](../test/media/web_test_dynamicparameter_runresultsquckfind4.png)

     Jak je znázorněno na kartě odpověď a v předchozím příkladu implementovaného v jazyce JavaScript, parametr řetězce dotazu CustomQueryString je přiřazena hodnota "jScriptQueryString___" a je také zřetězena s vrácenou hodnotou z var sessionId.

    ```javascript
    function jScriptQueryString()          {             var Hidden = document.getElementById("HiddenFieldSessionID");             var sessionId = Hidden.value;             window.location = 'JScriptQuery.aspx?CustomQueryString=jScriptQueryString___' + sessionId;          }

    ```

     Teď, když víte, kde k chybě dochází, a že potřebujeme extrahovat hodnotu pro sessionId. Hodnota extrakce je však pouze text, takže musíme tuto chybu dále izolovat tak, že zkusíte najít řetězec, ve kterém je zobrazena skutečná hodnota identifikátoru sessionId. Pohledem na kód vidíte, že var sessionId se rovná hodnotě vrácené funkcí HiddenFieldSessionID.

5. Použijte rychlé hledání na HiddenFieldSessionID, zrušte zaškrtnutí políčka hledání a vyberte aktuální požadavek.

     ![Použití rychlého hledání na HiddenFieldSession](../test/media/web_test_dynamicparameter_runresultsquckfindhiddensession.png)

     Všimněte si, že vrácená hodnota není stejný řetězec jako v původním záznamu testu výkonnosti webu. Pro tento testovací běh je vrácená hodnota "5w4v3yrse4wa4axrafykqksq" a v původním záznamu je hodnota "1v0yhyiyr0raa2w4j4pwf5zl". Vzhledem k tomu, že hodnota neodpovídá původnímu záznamu, je vygenerována chyba.

6. Vzhledem k tomu, že je nutné opravit dynamický parametr v původním záznamu, vyberte na panelu nástrojů možnost zaznamenaná výsledek.

     ![Zvolit zaznamenaný výsledek](../test/media/web_test_dynamicparameter_recordedresult.png)

7. V zaznamenaných výsledcích vyberte třetí žádost, což je stejný požadavek *Querystringrequest. aspx* , který je izolovaný ve výsledcích testovacího běhu.

     ![Zvolit stejný požadavek v zaznamenaných výsledcích](../test/media/web_test_dynamicparameter_recordedresultsselectnode.png)

     Vyberte kartu odpověď, posuňte se dolů a vyberte původní hodnotu dynamického parametru "1v0yhyiyr0raa2w4j4pwf5zl", který jste předtím Izoluji, a přidejte pravidlo extrakce.

     ![Přidat pravidlo extrakce pro dynamický parametr](../test/media/web_test_dynamicparameter_recordedresultaddextractionrule.png)

     Nové pravidlo pro extrakci je přidáno do žádosti *QueryString. aspx* a je mu přiřazena hodnota "Param0".

     Pokud se v dialogovém okně informuje, že byly nalezeny shody pro extrahovaný text, na který parametr naváže, vyberte **Ano**.

     ![Pravidlo extrakce bylo vytvořeno.](../test/media/web_test_dynamicparameter_addextractiondialog.png)

8. Vyberte **Najít další**. První shoda je ta, kterou potřebujeme změnit, což je parametr pro CustomQueryString pro stránku JScriptQuery.

     ![Vyhledat a nahradit text pro parametr](../test/media/web_test_dynamicparameter_addextractionfindreplace.png)

9. Vyberte **nahradit**.

     ![Nahraďte text parametrem.](../test/media/web_test_dynamicparameter_addextractionfindreplace2.png)

     Parametr QueryString pod požadavkem *JScriptQuery. aspx* se aktualizuje pomocí nového kontextu parametru: CustomQueryString = jScriptQueryString___ {{Param0}}.

     ![Parametr aplikovaný na QueryString](../test/media/web_test_dynamicparameter_addextractionfindreplace3.png)

10. Zavřete dialogové okno **Najít a nahradit** . Všimněte si podobné struktury ve stromu žádosti mezi zjištěným dynamickým parametrem a nezjištěným dynamickým parametrem, který jste koreluji.

     ![Zjištěné a korelační dynamické parametry](../test/media/web_test_dynamicparameter_conclusion.png)

11. Spusťte test. Nyní běží bez chyby.

## <a name="qa"></a>Otázky a odpovědi

### <a name="q-can-i-re-run-dynamic-parameter-detection-if-my-web-app-gets-modified"></a>Otázka: mohu znovu spustit detekci dynamického parametru, pokud se moje webová aplikace změní?

**A:** Ano, použijte následující postup:

1. Na panelu nástrojů klikněte na tlačítko **Povýšit dynamické parametry na parametry webového testu** .

     Po dokončení procesu zjišťování se zobrazí dialogové okno **Povýšit dynamické parametry na parametry webového testu** .

     Dynamické parametry jsou uvedeny ve sloupci dynamické parametry. Požadavky, na které bude dynamický parametr extrahován, jsou uvedeny v části extrahovat parametr z odpovědi a vazba na sloupce žádosti.

     Pokud zvolíte dynamický parametr v dialogovém okně **Povýšit dynamické parametry na parametry webového testu** , budou ve stromu žádostí Editor testu výkonnosti webu zvýrazněny dvě požadavky. První požadavek bude požadavek, do kterého se přidá pravidlo extrakce. Druhá žádost je místo, kde bude navázána extrahovaná hodnota.

2. Zaškrtněte nebo zrušte zaškrtnutí políčka u dynamických parametrů, které chcete automaticky korelovat. Ve výchozím nastavení jsou zaškrtnuty všechny dynamické parametry.

### <a name="q-do-i-need-to-configure-visual-studio-to-detect-dynamic-parameters"></a>Otázka: Potřebuji nakonfigurovat aplikaci Visual Studio k detekci dynamických parametrů?

**A:** Výchozí konfigurací sady Visual Studio je zjišťování dynamických parametrů při záznamu testu výkonnosti webu. Pokud máte ale možnosti sady Visual Studio nakonfigurované tak, aby nerozpoznaly dynamické parametry, nebo se webová aplikace, která je testována, změnila pomocí dalších dynamických parametrů; Přesto můžete spustit detekci dynamického parametru z Editor testu výkonnosti webu.
