---
title: Oprava nedetekovatelných dynamických parametrů v testu výkonnosti webu
ms.date: 10/19/2016
ms.topic: conceptual
helpviewer_keywords:
- walkthroughs, load tests
- load tests, walkthroughs
- load tests, correlating dynamic parameters
ms.assetid: 92dff25c-36ee-4135-acdd-315c4962fa11
author: gewarren
ms.author: gewarren
manager: douge
ms.prod: visual-studio-dev15
ms.technology: vs-ide-test
ms.openlocfilehash: 54f0b23da975738cf1dd33e03ef577efbfc2be38
ms.sourcegitcommit: 708f77071c73c95d212645b00fa943d45d35361b
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 12/07/2018
ms.locfileid: "53063778"
---
# <a name="fix-non-detectable-dynamic-parameters-in-a-web-performance-test"></a>Oprava nedetekovatelných dynamických parametrů v testu výkonnosti webu

Některé webové servery používají dynamické parametry pro zpracování některých ze svých webových žádostí. Dynamický parametr je parametr, jehož hodnota je znovu vygenerovány pokaždé, když uživatel spustí aplikaci. Příkladem dynamického parametru je ID relace. ID relace se obvykle změní každých 5 až 30 minut. Modul výkonu webu pro nahrávání a přehrávání automaticky zpracovává nejběžnější typy dynamických parametrů:

-   Hodnoty dynamického parametru nastavené v hodnotě souboru cookie. Modul výkonu webu automaticky zpracovává během přehrávání.

-   Stavu zobrazení hodnoty dynamického parametru nastavené ve skrytých polí na stránkách HTML, jako je například technologie ASP.NET. Jsou automaticky zpracovány záznamníkem, který do testu přidává skrytá pravidla extrakce pole.

-   Hodnoty dynamického parametru nastavené jako řetězec dotazu nebo formulář Parametry post. Tyto jsou zpracovány prostřednictvím zjišťování dynamického parametru po zaznamenání testu výkonnosti webu.

Některé typy dynamických parametrů nejsou zjištěny. Nerozpoznaný dynamický parametr způsobí, že váš test výkonnosti webu dojde k chybě při jeho spuštění, protože se dynamické hodnoty budou pravděpodobně lišit při každém spuštění testu. Správně zpracovat tyto parametry, můžete přidat pravidla extrakce k dynamickým parametrům v testech výkonu webu ručně.

[!INCLUDE [web-load-test-deprecated](includes/web-load-test-deprecated.md)]

## <a name="create-and-run-a-web-app-with-dynamic-parameters"></a>Vytvoření a spuštění webové aplikace s dynamickými parametry

Abychom si předvedli zjistitelný a nezjistitelný dynamický parametr, vytvoříme jednoduchou webovou aplikaci ASP.NET, obsahující tři webové formuláře s několika ovládacími prvky a některým vlastním kódem. Potom zjistíme jak izolovat dynamické parametry a způsob jejich zpracování.

1.  Vytvořte nový projekt ASP.NET s názvem **DynamicParameterSample**.

     ![Vytvořit prázdný projekt webové aplikace ASP.NET](../test/media/web_test_dynamicparameter_aspproject.png)

2.  Přidejte webový formulář s názvem *Querystring.aspx*.

3.  V návrhovém zobrazení přetáhněte HiddenField na stránku a v pak změňte hodnotu pro vlastnost (ID) na HiddenFieldSessionID.

     ![Přidat HiddenField](../test/media/web_test_dynamicparameter_hiddenfield.png)

4.  Přejděte do zobrazení zdroje stránky Querystring a přidejte následující zvýrazněný kód technologie ASP.NET a JavaScript používá ke generování dynamických parametrů mock relace ID:

    ```html
    <head runat="server">
    <title>JavaScript dynamic property correlation sample</title><script type="text/javascript" language="javascript">    <!--        function jScriptQueryString()         {            var Hidden = document.getElementById("HiddenFieldSessionID");            var sessionId = Hidden.value;            window.location = 'JScriptQuery.aspx?CustomQueryString=jScriptQueryString___' + sessionId;         }    //--></script>
    </head>
    <body>
        <form id="form1" runat="server">
        <div>
             <a name="QuerystringHyperlink" href="ASPQuery.aspx?CustomQueryString=ASPQueryString___<%= Session.SessionID %>">Dynamic querystring generated by ASP.net</a>         <br/>         <br/>         <a href="javascript:jScriptQueryString()">Dynamic querystring generated by javascript </a>
        </div>
        <asp:HiddenField ID="HiddenFieldSessionID" runat="server" />
        </form>
    </body>
    </html>
    ```

5.  Otevřít *Querystring.aspx.cs* soubor a do metody Page_Load přidejte následující zvýrazněný kód:

    ```csharp
    public partial class Querystring : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {
            Session.Add("Key", "Value");HiddenFieldSessionID.Value = Session.SessionID;
        }
    }
    ```

6.  Přidejte druhý webový formulář s názvem *ASPQuery.aspx*.

7.  V návrhovém zobrazení přetáhněte **popisek** na stránku a změňte hodnotu pro jeho **(ID)** vlastnost **IndexLabel**.

     ![Přidejte popisek do webového formuláře](../test/media/web_test_dynamicparameter_label.png)

8.  Přetáhněte **hypertextový odkaz** na stránku a změňte hodnotu pro jeho **Text** vlastnost **zpět**.

     ![Přidání hypertextového odkazu do webového formuláře](../test/media/web_test_dynamicparameter_hyperlink.png)

9. Zvolte **(...)**  pro **NavigationURL** vlastnost.

     ![Upravit vlastnost NavigateURL](../test/media/web_test_dynamicparameter_hyperlink_navurl.png)

     Vyberte *Querystring.aspx*.

     ![Zvolte adresu URL na Querystring.aspx](../test/media/web_test_dynamicparameter_hyperlink_navurl2.png)

10. Otevřít *ASPQuery.aspx.cs* soubor a do metody Page_Load přidejte následující zvýrazněný kód:

    ```csharp
    protected void Page_Load(object sender, EventArgs e)
            {
                int index;            string qstring;            string dateportion;            string sessionidportion;            qstring = Request.QueryString["CustomQueryString"];            index = qstring.IndexOf("___");            dateportion = qstring.Substring(0, index);            index += 3;            sessionidportion = qstring.Substring(index, qstring.Length - index);            if (sessionidportion != Session.SessionID)            {                Response.StatusCode = 401;                IndexLabel.Text = "Failure!  Invalid querystring parameter found.";            }            else            {                IndexLabel.Text = "Success.  Dynamic querystring parameter was found.";            }            IndexLabel.Text += "<br>\r\n";
            }
    ```

11. Přidejte třetí webový formulář s názvem *JScriptQuery.aspx*.

     Stejně jako na druhé stránce, přetáhněte **popisek** do formuláře, nastavte jeho **(ID)** vlastnost **IndexLabel** a přetáhněte ji **hypertextový odkaz** do formuláře, nastavte jeho **Text** vlastnost **zpět**a jeho **NavigationURL** vlastnost **Querystring.aspx**.

     ![Přidat a nakonfigurovat třetí webový formulář](../test/media/web_test_dynamicparameter_addwebform3.png)

12. Otevřít *JScriptQuery.aspx.cs* soubor a do metody Page_Load přidejte následující zvýrazněný kód:

    ```csharp
    protected void Page_Load(object sender, EventArgs e)
            {
                int index;            string qstring;            string dateportion;            string sessionidportion;            qstring = Request.QueryString["CustomQueryString"];            index = qstring.IndexOf("___");            dateportion = qstring.Substring(0, index);            index += 3;            sessionidportion = qstring.Substring(index, qstring.Length - index);            if (sessionidportion != Session.SessionID)            {                Response.StatusCode = 401;                IndexLabel.Text = "Failure!  Invalid querystring parameter found.";            }            else            {                IndexLabel.Text = "Success.  Dynamic querystring parameter was found.";            }            IndexLabel.Text += "<br>\r\n";
            }
    ```

13. Uložte projekt.

14. V **Průzkumníka řešení**, nastavte *Querystring.aspx* jako úvodní stránku.

     ![Nastavení úvodní stránky na Querystring.aspx](../test/media/web_test_dynamicparameter_setstartpage.png)

15. Stisknutím klávesy **Ctrl**+**F5** ke spuštění webové aplikace v prohlížeči. Zkopírujte adresu URL. Budete je potřebovat při nahrávání testu.

16. Zkuste oba odkazy. Měly by všechny zobrazovat zprávu "úspěch. Dynamické parametr querystring nalezen."

     ![Spuštění webové aplikace](../test/media/web_test_dynamicparameter_runapp.png)

     ![Úspěch&#33;](../test/media/web_test_dynamicparameter_runapp2.png)

## <a name="create-a-web-performance-test"></a>Vytvoření testu výkonnosti webu

1.  Přidáte webový výkon a projekt zátěžového testu do vašeho řešení.

     ![Přidejte projekt testu výkonu a zatížení webu](../test/media/web_test_dynamicparameter_addtestproject.png)

2.  Přejmenujte WebTest1.webtest na DynamicParameterSampleApp.webtest.

     ![Přejmenujte test výkonnosti webu](../test/media/web_test_dynamicparameter_renametest.png)

3.  Záznam testu.

     ![Záznam testu výkonnosti webu](../test/media/web_test_dynamicparameter_recordtest.png)

4.  Zkopírujte a vložte adresu URL z webu, který testujete do prohlížeče.

     ![Vložte adresu URL webu, který je právě testováno](../test/media/web_test_dynamicparameter_recordtest2.png)

5.  Procházejte webovou aplikací. Vyberte odkaz ASP.NET, odkaz zpět a potom odkaz javascript, následovaný odkazem zpět.

     Rekordér webového testu zobrazí adresu URL požadavku a odpovědi HTTP v průběhu procházení webové aplikace.

6.  Zvolte **Zastavit** tlačítko v rekordéru testů.

     Dialogové okno pro zjišťování dynamických parametrů zobrazí indikátor průběhu, který zobrazuje stavem zjišťování parametrů v přijatých odpovědích HTTP.

7.  Dynamický parametr CustomQueryString na stránce Apsquery je automaticky rozpoznán. Však rozpoznán dynamický parametr CustomQueryString na stránce JScriptQuery.

     Zvolte **OK** pro přidání pravidla pro extrakci do *Querystring.aspx*, vytvoříte jejich vazbu na stránce ASPQuery.

     ![Zvýšit úroveň zjištěným dynamickým parametrem](../test/media/web_test_dynamicparameter_promotedialog.png)

     Pravidlo extrakce je přidáno k první žádosti o *Querystring.aspx*.

     ![Pravidlo pro extrakci přidáno k žádosti](../test/media/web_test_dynamicparameter_autoextractionrule.png)

     Rozbalte druhou žádost ve stromové struktuře požadavku pro *ASPQuery.aspx* a Všimněte si, že okně CustomQueryString hodnota byla svázána se pravidlo pro extrakci.

     ![CustomQueryString vázána na pravidlo pro extrakci](../test/media/web_test_dynamicparameter_autoextractionrule2.png)

8.  Uložte tento test.

## <a name="run-the-test-to-isolate-the-non-detected-dynamic-parameter"></a>Spuštění testu k izolaci nezjištěné dynamického parametru

1.  Spusťte test.

     ![Spuštění testu výkonnosti webu](../test/media/web_test_dynamicparameter_runtest.png)

2.  Čtvrtá žádost o *JScriptQuery.aspx* stránky nezdaří. Přejdete na webový test.

     ![Dynamický parametr chyby ve výsledcích testu](../test/media/web_test_dynamicparameter_runresults.png)

     *JScriptQuery.aspx* v editoru je zvýrazněn uzel žádosti. Rozbalte uzel a Všimněte si, že část CustomQueryString "1v0yhyiyr0raa2w4j4pwf5zl" se zdá být dynamické.

     ![Podezření na dynamický parametr CustomQueryString](../test/media/web_test_dynamicparameter_runresults2.png)

3.  Vraťte se do prohlížeče výsledků testu výkonu webu a vyberte *JScriptQuery.aspx* stránky, která se nezdařila. Potom vyberte kartu žádosti, ověřte, zda je zaškrtnuté políčko Zobrazit nezpracovaná data, posuňte se dolů a zvolte možnost rychle najít v okně CustomQueryString.

     ![Použití rychlého hledání k izolaci dynamických parametrů](../test/media/web_test_dynamicparameter_runresultsquckfind.png)

4.  Z pohledu do editoru testů víme, který *JScriptQuery.aspx* CustomQueryString požadavku byla přiřazena hodnota: `jScriptQueryString___1v0yhyiyr0raa2w4j4pwf5zl`, a že podezřelá dynamická část je "1v0yhyiyr0raa2w4j4pwf5zl". Do pole Najít rozevíracím seznamu, odstraňte podezřelou část vyhledávacího řetězce. Řetězec by měl být "CustomQueryString = jScriptQueryString___".

     Dynamické parametry jsou přiřazeny svým hodnotám v jednom z požadavků, které předchází požadavek, který obsahuje chybu. Proto vyberte zaškrtávací políčko Hledat a zvolte Najít další, dokud se nezobrazí předchozí požadavek na *Querystring.aspx* zvýrazněný na panelu požadavku. To by mělo nastat po výběru najít další třikrát.

     ![Použití rychlého hledání k izolaci dynamických parametrů](../test/media/web_test_dynamicparameter_runresultsquckfind4.png)

     Jak je znázorněno na kartě odpovědi a v jazyce JavaScript implementované výše je uvedeno níže, parametru řetězce dotazu CustomQueryString je přiřazena hodnota "jscriptquerystring___" a je také spojena s vrácenou hodnotu z var sessionId.

    ```javascript
    function jScriptQueryString()          {             var Hidden = document.getElementById("HiddenFieldSessionID");             var sessionId = Hidden.value;             window.location = 'JScriptQuery.aspx?CustomQueryString=jScriptQueryString___' + sessionId;          }

    ```

     Teď, když víme, kde dochází k chybě. proto, že potřebujeme extrahovat hodnotu sessionId. Extrakce hodnoty je však pouze text, takže musíme dále izolovat chyby pokusu o nalezení řetězce, kde se zobrazí skutečná hodnota identifikátoru sessionId. Pohledem kód, uvidíte, že var sessionId se rovná hodnotě vrácené funkcí HiddenFieldSessionID.

5.  Použijte rychlé hledání v HiddenFieldSessionID, zrušení zaškrtávací políčko Hledat a výběru aktuálního požadavku.

     ![Použití rychlého hledání na HiddenFieldSession](../test/media/web_test_dynamicparameter_runresultsquckfindhiddensession.png)

     Všimněte si, že vrácená hodnota je záznam není stejný řetězec jako původní testu výkonnosti webu. Pro tento testovací běh je vrácená hodnota "5w4v3yrse4wa4axrafykqksq" a v původním záznamu je hodnota "1v0yhyiyr0raa2w4j4pwf5zl". Vzhledem k tomu, že hodnota neodpovídá původní nahrávce, je generována chyba.

6.  Vzhledem k tomu, že máme opravit dynamický parametr v původním záznamu, zvolte zaznamenané výsledky v panelu nástrojů.

     ![Zvolte zaznamenané výsledky](../test/media/web_test_dynamicparameter_recordedresult.png)

7.  U zaznamenaných výsledků vyberte třetí žádost, která je stejná *Querystringrequest.aspx* požadavek, který jste izolovali ve výsledcích testu.

     ![U zaznamenaných výsledků vyberte stejný požadavek](../test/media/web_test_dynamicparameter_recordedresultsselectnode.png)

     Vyberte kartu odpověď, posuňte se dolů a vyberte původní hodnotu dynamického parametru "1v0yhyiyr0raa2w4j4pwf5zl", který jste dříve izolovali a přidejte pravidla pro extrakci.

     ![Přidání pravidla extrakce pro dynamický parametr](../test/media/web_test_dynamicparameter_recordedresultaddextractionrule.png)

     Nové pravidlo extrakce je přidáno do *Querystring.aspx* žádosti a je mu přiřazena hodnota "Param0".

     Pokud dialogové okno nás informuje, že pro extrahovaný text, který má svázat parametr, zvolte byly nalezeny shody **Ano**.

     ![Vytvořit pravidlo pro extrakci](../test/media/web_test_dynamicparameter_addextractiondialog.png)

8.  Zvolte **najít další**. První shoda je ta, kterou chcete změnit, což je parametr pro CustomQueryString na stránce JScriptQuery.

     ![Najít a nahradit text pro parametr](../test/media/web_test_dynamicparameter_addextractionfindreplace.png)

9. Zvolte **nahradit**.

     ![Pomocí parametru nahradit text](../test/media/web_test_dynamicparameter_addextractionfindreplace2.png)

     Parametr QueryString *JScriptQuery.aspx* požadavku se aktualizuje s použitím nového parametru kontextu: CustomQueryString = jScriptQueryString___ {{Param0}}.

     ![Parametr použitý pro řetězce dotazu](../test/media/web_test_dynamicparameter_addextractionfindreplace3.png)

10. Zavřít **najít a nahradit** dialogového okna. Všimněte si podobné struktury ve stromové struktuře požadavku mezi zjištěným dynamickým parametrem a nezjištěné dynamické parametr, který je korelační.

     ![Zjištěné a korelační dynamické parametry](../test/media/web_test_dynamicparameter_conclusion.png)

11. Spusťte test. Nyní se spouští bez chyby.

## <a name="qa"></a>FUNKCE Q &AMP; A

### <a name="q-can-i-re-run-dynamic-parameter-detection-if-my-web-app-gets-modified"></a>Otázka: Mohu znovu spustit zjišťování dynamického parametru Pokud Moje webové aplikace upraveny?

 **Odpověď:** Ano, použijte následující postup:

1.  Na panelu nástrojů položku **povýšit dynamické parametry na parametry webového testu** tlačítko.

     Po dokončení procesu zjišťování, pokud nejsou zjištěny žádné dynamické parametry, **parametry testu povýšit dynamické parametry na webu** zobrazí se dialogové okno.

     Dynamické parametry jsou uvedeny ve sloupci dynamické parametry. Požadavky, že dynamického parametru se extrahují z a vázán na patří extrahovat parametr z odpovědi a svázat na žádost o sloupce.

     Pokud zvolíte dynamický parametr v **parametry testu povýšit dynamické parametry na webu** dialogové okno, dva požadavky budou zvýrazněny ve stromu žádosti Editor testu výkonnosti webu. První požadavek bude požadavek, který se pravidlo pro extrakci se přidají do. Druhý požadavek je, kde bude vázána Extrahovaná hodnota.

2.  Zaškrtněte nebo zrušte zaškrtnutí políčka u dynamických parametrů, které chcete automaticky sladit. Ve výchozím nastavení zkontrolují se všechny dynamické parametry.

### <a name="q-do-i-need-to-configure-visual-studio-to-detect-dynamic-parameters"></a>Dotaz: Potřebuji konfigurovat Visual Studio ke zjištění dynamických parametrů?

 **Odpověď:** výchozí konfigurace sady Visual Studio je k rozpoznání dynamických parametrů při záznamu testu výkonnosti webu. Ale pokud máte nakonfigurovat možnosti aplikace Visual Studio není k rozpoznání dynamických parametrů, nebo testovaná webová aplikace byla změněna dalšími dynamickými parametry; můžete spustit zjišťování dynamického parametru z editoru testu výkonnosti webu.